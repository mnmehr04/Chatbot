<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Simple AI Chatbot</title>

    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
      }

      .chat-container {
        width: 420px;
        margin: 40px auto;
        background: white;
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .messages {
        height: 350px;
        overflow-y: auto;
        margin-bottom: 15px;
      }

      .message-row {
        display: flex;
        margin-bottom: 10px;
        align-items: flex-end;
      }

      .user {
        justify-content: flex-end;
      }

      .robot {
        justify-content: flex-start;
      }

      .bubble {
        max-width: 260px;
        padding: 12px;
        border-radius: 10px;
        font-size: 14px;
      }

      .user .bubble {
        background: #d1e7ff;
      }

      .robot .bubble {
        background: #eaeaea;
      }

      .message-row img {
        width: 32px;
        margin: 0 6px;
      }

      .input-row {
        display: flex;
        gap: 8px;
      }

      .input-row input {
        flex: 1;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
      }

      .input-row button {
        padding: 12px 16px;
        background: green;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div class="js-root"></div>

    <!-- React -->
    <script src="https://unpkg.com/supersimpledev@8.6.4/react.js"></script>
    <script src="https://unpkg.com/supersimpledev@8.6.4/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev@8.6.4/babel.js"></script>

    <!-- Simple chatbot logic -->
    <script src="https://unpkg.com/supersimpledev@8.6.4/chatbot.js"></script>

    <script type="text/babel">
      function ChatInput({ onSend }) {
        const [text, setText] = React.useState("");

        function send() {
          if (!text.trim()) return;
          onSend(text);
          setText("");
        }

        function handleKey(e) {
          if (e.key === "Enter") send();
        }

        return (
          <div className="input-row">
            <input
              placeholder="Type a message..."
              value={text}
              onChange={(e) => setText(e.target.value)}
              onKeyDown={handleKey}
            />
            <button onClick={send}>Send</button>
          </div>
        );
      }

      function Message({ message }) {
        return (
          <div className={`message-row ${message.sender}`}>
            {message.sender === "robot" && <img src="robot.png" />}
            <div className="bubble">{message.text}</div>
            {message.sender === "user" && <img src="user.png" />}
          </div>
        );
      }

      function Messages({ list }) {
        const bottomRef = React.useRef(null);

        React.useEffect(() => {
          bottomRef.current?.scrollIntoView({ behavior: "smooth" });
        }, [list]);

        return (
          <div className="messages">
            {list.map((msg) => (
              <Message key={msg.id} message={msg} />
            ))}
            <div ref={bottomRef}></div>
          </div>
        );
      }

      function App() {
        const [messages, setMessages] = React.useState([
          { id: 1, text: "Hi! I'm your chatbot ðŸ‘‹", sender: "robot" },
        ]);

        function handleSend(userText) {
          const userMsg = {
            id: crypto.randomUUID(),
            text: userText,
            sender: "user",
          };

          const botReply = {
            id: crypto.randomUUID(),
            text: Chatbot.getResponse(userText),
            sender: "robot",
          };

          setMessages((prev) => [...prev, userMsg, botReply]);
        }

        return (
          <div className="chat-container">
            <Messages list={messages} />
            <ChatInput onSend={handleSend} />
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.querySelector(".js-root"));
      root.render(<App />);
    </script>
  </body>
</html>
